@model consultancysolution.Models.AdmissionFeeDto
@{
    var disableAdmissionFormAttr = (ViewBag.AdmissionFormMode == "Add") ? "" : "disabled";
}
<div class="AdmissionInfo">
    <h5>Admission Fee</h5>
    <table class="table table-bordered">
        <thead>
            <tr>
                <th>Admission Fee</th>
                <th>Discount</th>
                <th>Modified Fee</th>
                <th>Paid</th>
                <th>Due</th>
            </tr>
        </thead>
        <tbody>
            <tr id="admissionFeeRow">
                @if (Model != null)
                {
                    <td><input id="admissionFee" class="form-control" type="number" value="@Model.AdmissionFee" @disableAdmissionFormAttr/></td>
                    <td><input class="form-control" type="number" id="admissionFeeDiscount"
                            value="@Model.Discount" @disableAdmissionFormAttr/></td>
                    <td><span id="modifiedAdmissionFee">@Model.ModifiedAdmissionFee </span></td>
                    <td><input type="number" class="form-control" id="paidAdmissionAmount" value="@Model.Paid" @disableAdmissionFormAttr/></td>
                    <td><span id="dueAdmissionAmount">@Model.Due</span></td>
                }
                else
                {
                    <td><input id="admissionFee" class="form-control" type="number" value="@(Model?.AdmissionFee ?? 0)" @disableAdmissionFormAttr/></td>
                    <td><input class="form-control" type="number" id="admissionFeeDiscount"
                            value="@(Model?.Discount ?? 0)" @disableAdmissionFormAttr/></td>
                    <td><span id="modifiedAdmissionFee">@(Model?.ModifiedAdmissionFee ?? 0)</span></td>
                    <td><input type="number" class="form-control" id="paidAdmissionAmount" value="@(Model?.Paid ?? 0)" @disableAdmissionFormAttr/></td>
                    <td><span id="dueAdmissionAmount">@(Model?.Due ?? 0)</span></td>
                }
            </tr>
        </tbody>
    </table>
    <div class="col-sm-12 d-flex justify-content-end gap-2">
        
    @{
        if (ViewBag.AdmissionFormMode == "Edit")
        {
            <button id="editAdmissionFee" class="btn btn-warning">Edit</button>
            <button id="updateAdmissionFee" class="btn btn-primary" style="display:none;">Update Admission
                Fee</button>
            <button id="cancelAdmissionFee" class="btn btn-secondary" style="display:none;">Cancel</button>
        }
        else
        {
            <button id="saveAdmissionFee" class="btn btn-primary">Save Admission Fee</button>
        }
    }
    <button type="button" class="closeBtn btn btn-secondary"
        onclick="window.location.href='/Students/Index';">Close</button>
        </div>
</div>
<script>
    //admission fee container script
    function getValue(selector) {
            const el = $(selector);
            if (el.is('input')) {
                return parseFloat(el.val()) || 0;
            } else {
                return parseFloat(el.text()) || 0;
            }
    }
    function updateCalculatedFields() {
        debugger;
        const admissionFee = getValue("#admissionFee");
        const discount = getValue("#admissionFeeDiscount");
        const paid = getValue("#paidAdmissionAmount");

        const modifiedFee = Math.max(0, admissionFee - discount);
        const due = Math.max(0, modifiedFee - paid);

        $("#modifiedAdmissionFee").text(modifiedFee.toFixed(2));
        $("#dueAdmissionAmount").text(due.toFixed(2));
    }
    $("#admissionFee, #admissionFeeDiscount, #paidAdmissionAmount").on("input", updateCalculatedFields);
    //admission fee container script end
</script>
